!function(n,a,t,i){if(n.Insertagram=function(n){this.config={instagram:{apiDomain:"https://api.instagram.com/v1",apiMaxCount:20},$el:{form:a("#insertagram-admin-form"),wrap:a(".wrap").first(),buttonMore:a(".insertagram__button--more"),buttonSubmit:a(".insertagram__button--submit"),container:a("#insertagram-gallery-admin"),galleryAdmin:a(".insertagram-gallery-admin-content"),template:{figure:a("#insertagram-template-admin-gallery-figure").html(),inputs:a("#insertagram-template-admin-gallery-inputs").html(),messages:a("#insertagram-template-admin-messages").html()}}},this.config.instagram=t.extend(this.config.instagram,insertagramConfig.instagram),this.config=t.extend(this.config,n)},n.Insertagram.prototype={fetch:function(n,t,i,e){var r={url:n,type:"GET",dataType:t,cache:!1,async:!0};i&&(r.jsonpCallback=i),a.ajax(r).done(function(n){e.call(this,n)}).error(function(n){console.log("ajax error: ",n)})},getRecent:function(n,a){var t=this,i=t.config.instagram.apiDomain+"/users/"+n+"/media/recent/?count="+t.config.instagram.apiMaxCount+"&access_token="+t.config.instagram.token;t.fetch(i,"jsonp",!1,a)},bindEvents:function(n){var i=this;n.find("figure").off(),n.find("figure").on("click",function(n){n.preventDefault();var e=a(this),r=e.attr("data-index");if(e.hasClass("active"))i.config.$el.form.find("#insertagram-form-node-"+r).remove(),a(this).removeClass("active");else{var o=t.template(i.config.$el.template.inputs),s=o({index:r,instagramId:e.attr("data-instagram_id")});i.config.$el.form.append(s),e.addClass("active")}}),i.config.$el.buttonMore.off(),i.config.$el.buttonMore.on("click",function(n){n.preventDefault();var t=a(this),e=a(this).attr("data-url");t.parent().addClass("loading"),i.fetch(e,"jsonp",!1,function(n){t.parent().removeClass("loading"),i.displayRecent(n)})}),i.config.$el.buttonSubmit.on("click",function(n){i.config.$el.container.addClass("loading--submit")})},displayRecent:function(n){var a=this,i=n.data,e=n.pagination&&!n.pagination.next_url?!1:n.pagination.next_url;a.config.$el.buttonSubmit.addClass("active"),a.config.$el.container.addClass("active");for(var r=0;r<i.length;r++){var o=i[r].id?i[r].id:"",s=t.template(a.config.$el.template.figure),g=s({index:r,instagramId:o,imageLowUrl:i[r].images.low_resolution.url});a.config.$el.galleryAdmin.append(g),r+1===i.length&&(e?(a.config.$el.buttonMore.addClass("active"),a.config.$el.buttonMore.attr("data-url",e)):a.config.$el.buttonMore.removeClass("active"),a.bindEvents(a.config.$el.galleryAdmin))}},initialize:function(){var a=this;if(a.config.instagram.userId&&a.config.instagram.token&&""!==a.config.instagram.userId&&""!==a.config.instagram.token)n.insertagramConfig.shortcodePage&&a.getRecent(a.config.instagram.userId,function(n){a.displayRecent(n)});else{""===a.config.instagram.userId&&console.log("Insertagram: User ID is not set."),""===a.config.instagram.token&&console.log("Insertagram: Access Token is not set.")}}},n.insertagramConfig){var e=new Insertagram;e.initialize()}}(window,jQuery,_);