!function(a,i,n,t){if(a.Insertagram=function(a){this.config={instagram:{apiDomain:"https://api.instagram.com/v1",apiMaxCount:20},template:{figure:i("#insertagram-template-gallery-figure").html(),figureOverlay:i("#insertagram-template-gallery-figure-overlay").html()}},this.config.instagram=n.extend(this.config.instagram,insertagramConfig.instagram),this.config.instances=insertagramConfig.instances,this.config.feeds=insertagramConfig.feeds,this.config=n.extend(this.config,a)},a.Insertagram.prototype={fetch:function(a,n){i.ajax({url:a,type:"GET",dataType:"jsonp",cache:!1,async:!0}).done(function(a){n.call(this,a)}).error(function(a){console.log("ajax error: ",a)})},bindEvents:function(a){var n=this,t=a.find(".insertagram__button--more");t.on("click",function(a){a.preventDefault();var t=i(this),e=t.attr("data-next"),r=t.attr("data-feed");t.parent().addClass("loading"),n.fetch(e,function(a){n.displayFeed(a,r),t.parent().removeClass("loading"),t.remove()})})},getMediaData:function(a,i){var n=this,t=n.config.instagram.apiDomain+"/media/"+a+"?access_token="+n.config.instagram.token;n.fetch(t,i)},getRecent:function(a,i){var n=this,t=n.config.instagram.apiDomain+"/users/"+a+"/media/recent/?count="+n.config.instagram.apiMaxCount+"&access_token="+n.config.instagram.token;n.fetch(t,i)},displayMedia:function(a,i,t){var e=this,r="",o="",s=i.caption&&i.caption.text&&""!==i.caption.text?i.caption.text:!1;if(t){var g=n.template(e.config.template.figureOverlay),c=g({username:i.user.username,profilePicture:i.user.profile_picture,caption:s,likesCount:i.likes.count,commentsCount:i.comments.count});r=c,o=" insertagram--info"}var f=n.template(e.config.template.figure),d=f({userId:i.user.id,infoClass:o,overlay:r,type:i.type,mediaLink:i.link,imageStandardUrl:i.images.standard_resolution.url});a.find(".insertagram-gallery").append(d),setTimeout(function(){a.find("a").addClass("active")},150)},displayFeed:function(a,n){var t=this,e=t.config.feeds[n],r=a.data,o=a.pagination&&a.pagination.next_url?a.pagination.next_url:!1,s=i("#insertagram-container-"+e.id);if(o){var g='<div class="insertagram__preloader"><div></div><div></div><div>',c=i('<button class="insertagram__button--more" data-next="'+o+'" data-feed="'+n+'">'+g+"</div></div>More</button>");s.append(c),setTimeout(function(){c.addClass("active")},300)}for(var f=0;f<r.length;f++){var d=r[f];t.displayMedia(s,d,e.info),f===r.length-1&&t.bindEvents(s)}},initialize:function(){var a=this;if(a.config.instagram.userId&&a.config.instagram.token&&""!==a.config.instagram.userId&&""!==a.config.instagram.token){if(a.config.instances.length>0)for(var n=0;n<a.config.instances.length;n++){var t=a.config.instances[n];a.getMediaData(t.id,function(n){var e=i("#insertagram-container-"+t.timestamp);a.displayMedia(e,n.data,t.info)})}if(a.config.feeds.length>0)for(var e=0;e<a.config.feeds.length;e++){var r=e;a.getRecent(a.config.instagram.userId,function(i){a.displayFeed(i,r)})}}}},a.insertagramConfig){var e=new Insertagram;e.initialize()}}(window,jQuery,_);